@{
    ViewData["Title"] = "Thanh toán bị hủy";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var orderId = ViewBag.OrderId as int?;
    var orderTotal = ViewBag.OrderTotal as decimal?;
}

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Cancel Header -->
            <div class="text-center mb-5">
                <div class="cancel-icon mb-3">
                    <i class="fas fa-times-circle text-warning" style="font-size: 5rem;"></i>
                </div>
                <h2 class="fw-bold text-warning">Thanh toán bị hủy</h2>
                <p class="text-muted">Bạn đã hủy thanh toán qua PayPal</p>
            </div>

            <!-- Info Card -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">
                        <i class="fas fa-info-circle text-primary"></i>
                        Thông tin đơn hàng
                    </h5>
                    
                    @if (orderId.HasValue)
                    {
                        <div class="alert alert-warning" role="alert">
                            <h6 class="alert-heading">
                                <i class="fas fa-exclamation-triangle"></i>
                                Đơn hàng #@orderId đã bị hủy thanh toán
                            </h6>
                            <p class="mb-0">
                                Đơn hàng của bạn vẫn được lưu trong hệ thống với trạng thái "Chờ thanh toán".
                                Bạn có thể quay lại và thử thanh toán lại hoặc chọn phương thức thanh toán khác.
                            </p>
                        </div>

                        @if (orderTotal.HasValue)
                        {
                            <div class="border rounded p-3 bg-light">
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="fw-bold">Tổng tiền đơn hàng:</span>
                                    <span class="fs-5 text-primary fw-bold">
                                        @orderTotal.Value.ToString("N0") đ
                                    </span>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="alert alert-info" role="alert">
                            <p class="mb-0">
                                <i class="fas fa-info-circle"></i>
                                Thanh toán của bạn đã bị hủy. Nếu bạn muốn tiếp tục mua hàng, 
                                vui lòng quay lại giỏ hàng và thực hiện lại quá trình thanh toán.
                            </p>
                        </div>
                    }
                </div>
            </div>

            <!-- Why was payment cancelled? -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">
                        <i class="fas fa-question-circle text-primary"></i>
                        Tại sao thanh toán bị hủy?
                    </h5>
                    
                    <p>Có một số lý do phổ biến khiến thanh toán PayPal bị hủy:</p>
                    
                    <ul class="list-unstyled">
                        <li class="mb-2">
                            <i class="fas fa-times text-danger me-2"></i>
                            Bạn đã nhấn nút "Hủy" trong trang thanh toán PayPal
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-credit-card text-danger me-2"></i>
                            Không đủ số dư trong tài khoản PayPal
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-clock text-danger me-2"></i>
                            Phiên thanh toán đã hết hạn
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-exclamation-triangle text-danger me-2"></i>
                            Lỗi kỹ thuật từ PayPal
                        </li>
                    </ul>
                </div>
            </div>

            <!-- What can you do now? -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <h5 class="card-title mb-3">
                        <i class="fas fa-lightbulb text-primary"></i>
                        Bạn có thể làm gì tiếp theo?
                    </h5>
                    
                    <div class="list-group list-group-flush">
                        <div class="list-group-item d-flex align-items-start">
                            <div class="me-3">
                                <i class="fas fa-redo text-success fs-4"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">Thử lại thanh toán PayPal</h6>
                                <p class="mb-0 text-muted small">
                                    Kiểm tra lại tài khoản PayPal và thử thanh toán lại
                                </p>
                            </div>
                        </div>
                        
                        <div class="list-group-item d-flex align-items-start">
                            <div class="me-3">
                                <i class="fas fa-exchange-alt text-primary fs-4"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">Chọn phương thức thanh toán khác</h6>
                                <p class="mb-0 text-muted small">
                                    Sử dụng COD (thanh toán khi nhận hàng) hoặc VNPay
                                </p>
                            </div>
                        </div>
                        
                        <div class="list-group-item d-flex align-items-start">
                            <div class="me-3">
                                <i class="fas fa-headset text-info fs-4"></i>
                            </div>
                            <div>
                                <h6 class="mb-1">Liên hệ hỗ trợ</h6>
                                <p class="mb-0 text-muted small">
                                    Nếu bạn gặp khó khăn, hãy liên hệ với chúng tôi
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="row g-3">
                <div class="col-md-4">
                    <a href="@Url.Action("Index", "Cart")" class="btn btn-outline-primary w-100">
                        <i class="fas fa-shopping-cart"></i>
                        Giỏ hàng
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="@Url.Action("Index", "Checkout")" class="btn btn-warning w-100">
                        <i class="fas fa-redo"></i>
                        Thử lại
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="@Url.Action("Index", "Home")" class="btn btn-primary w-100">
                        <i class="fas fa-home"></i>
                        Trang chủ
                    </a>
                </div>
            </div>

            <!-- Contact Support -->
            <div class="alert alert-light border mt-4" role="alert">
                <h6 class="alert-heading">
                    <i class="fas fa-phone-alt"></i>
                    Cần trợ giúp?
                </h6>
                <p class="mb-0">
                    Hotline: <strong>1900-xxxx</strong> | 
                    Email: <a href="mailto:support@sportsshop.com">support@sportsshop.com</a> |
                    Giờ làm việc: 8:00 - 22:00 hàng ngày
                </p>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .cancel-icon {
            animation: shake 0.5s ease-out;
        }
        
        @@keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            10%, 30%, 50%, 70%, 90% {
                transform: translateX(-5px);
            }
            20%, 40%, 60%, 80% {
                transform: translateX(5px);
            }
        }
        
        .card {
            border: none;
            border-radius: 12px;
        }
        
        .list-group-item {
            border: none;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .list-group-item:last-child {
            border-bottom: none;
        }
        
        .btn {
            font-weight: 500;
            padding: 12px;
        }
    </style>
}

@section Scripts {
    <script>
        console.log('Payment cancelled for order: @(orderId ?? 0)');
    </script>
}
